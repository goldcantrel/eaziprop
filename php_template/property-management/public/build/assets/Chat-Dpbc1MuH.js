import{r as a,s as n,j as s}from"./app-Duh4pxuZ.js";function b(){const[i,c]=a.useState([]),[o,l]=a.useState(""),[u,m]=a.useState(!0),d=a.useRef(null);a.useEffect(()=>{f(),x()},[]);const g=()=>{var e;(e=d.current)==null||e.scrollIntoView({behavior:"smooth"})};a.useEffect(()=>{g()},[i]);async function f(){const{data:{user:e}}=await n.auth.getUser(),{data:t,error:r}=await n.from("properties_593nwd_chat_messages").select("*").eq("user_email",e.email).order("created_at",{ascending:!0});r?console.error("Error loading messages:",r):c(t||[]),m(!1)}function x(){const e=n.channel("properties_593nwd_chat_messages").on("INSERT",t=>{c(r=>[...r,t.new])}).subscribe();return()=>e.unsubscribe()}async function p(e){if(e.preventDefault(),!o.trim())return;const{data:{user:t}}=await n.auth.getUser(),{error:r}=await n.from("properties_593nwd_chat_messages").insert([{user_email:t.email,content:o.trim(),created_at:new Date().toISOString()}]);r?console.error("Error sending message:",r):l("")}return s.jsx("div",{className:"min-h-screen bg-gray-100 p-6",children:s.jsx("div",{className:"max-w-3xl mx-auto bg-white rounded-lg shadow-sm overflow-hidden",children:s.jsxs("div",{className:"h-[600px] flex flex-col",children:[s.jsx("div",{className:"flex-1 p-4 overflow-y-auto",children:u?s.jsx("div",{children:"Loading messages..."}):s.jsxs("div",{className:"space-y-4",children:[i.map(e=>s.jsxs("div",{className:"flex flex-col",children:[s.jsx("div",{className:"text-sm text-gray-500",children:e.user_email}),s.jsx("div",{className:"bg-gray-100 rounded-lg p-3 mt-1",children:e.content})]},e.id)),s.jsx("div",{ref:d})]})}),s.jsx("form",{onSubmit:p,className:"border-t p-4",children:s.jsxs("div",{className:"flex space-x-4",children:[s.jsx("input",{type:"text",value:o,onChange:e=>l(e.target.value),placeholder:"Type your message...",className:"flex-1 rounded-lg border-gray-300 focus:ring-primary-500 focus:border-primary-500"}),s.jsx("button",{type:"submit",className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 focus:outline-none focus:ring-2 focus:ring-primary-500 focus:ring-offset-2",children:"Send"})]})})]})})})}export{b as default};
